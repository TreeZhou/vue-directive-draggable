(function e(t,r){if(typeof exports==="object"&&typeof module==="object")module.exports=r();else if(typeof define==="function"&&define.amd)define([],r);else if(typeof exports==="object")exports["vue-directive-draggable"]=r();else t["vue-directive-draggable"]=r()})(typeof self!=="undefined"?self:this,function(){/******/
return function(e){// webpackBootstrap
/******/ // The module cache
/******/var t={};
/******/
/******/ // The require function
/******/function r(n){
/******/
/******/ // Check if module is in cache
/******/if(t[n]){
/******/return t[n].exports;
/******/}
/******/ // Create a new module (and put it into the cache)
/******/var o=t[n]={
/******/i:n,
/******/l:false,
/******/exports:{}
/******/};
/******/
/******/ // Execute the module function
/******/e[n].call(o.exports,o,o.exports,r);
/******/
/******/ // Flag the module as loaded
/******/o.l=true;
/******/
/******/ // Return the exports of the module
/******/return o.exports;
/******/}
/******/
/******/
/******/ // expose the modules object (__webpack_modules__)
/******/r.m=e;
/******/
/******/ // expose the module cache
/******/r.c=t;
/******/
/******/ // define getter function for harmony exports
/******/r.d=function(e,t,n){
/******/if(!r.o(e,t)){
/******/Object.defineProperty(e,t,{
/******/configurable:false,
/******/enumerable:true,
/******/get:n
/******/});
/******/}
/******/};
/******/
/******/ // getDefaultExport function for compatibility with non-harmony modules
/******/r.n=function(e){
/******/var t=e&&e.__esModule?
/******/function t(){return e["default"]}:
/******/function t(){return e};
/******/r.d(t,"a",t);
/******/return t;
/******/};
/******/
/******/ // Object.prototype.hasOwnProperty.call
/******/r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};
/******/
/******/ // __webpack_public_path__
/******/r.p="";
/******/
/******/ // Load entry module and return exports
/******/return r(r.s=0);
/******/}
/************************************************************************/
/******/([
/* 0 */
/***/function(e,t,r){"use strict";e.exports=r(1);
/***/},
/* 1 */
/***/function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}
/*!
 * vue-dragging v1.0.0
 * (c) 2019 527533739@qq.com
 * Released under the MIT License.
 */var a=function(){function e(){o(this,e);this.data={}}n(e,[{key:"new",value:function e(t){if(!this.data[t]){this.data[t]={List:[],KEY_MAP:{}}}return this.data[t]}},{key:"get",value:function e(t){return this.data[t]}}]);return e}();var i={listeners:{},$on:function e(t,r){var n=this.listeners[t];if(!n){this.listeners[t]=[]}this.listeners[t].push(r)},$once:function e(t,r){var n=this;function o(){n.$off(t,o);for(var e=arguments.length,a=Array(e),i=0;i<e;i++){a[i]=arguments[i]}r.apply(n,a)}this.$on(t,o)},$off:function e(t,r){var n=this.listeners[t];if(!r||!n){this.listeners[t]=[];return}this.listeners[t]=this.listeners[t].filter(function(e){return e!==r})},$emit:function e(t,r){var n=this.listeners[t];if(n&&n.length>0){n.forEach(function(e){e(r)})}}};var f={on:function e(t,r,n){t.addEventListener(r,n)},off:function e(t,r,n){t.removeEventListener(r,n)},addClass:function e(t,r){if(arguments.length<2){t.classList.add(r)}else{for(var n=1,o=arguments.length;n<o;n++){t.classList.add(arguments[n])}}},removeClass:function e(t,r){if(arguments.length<2){t.classList.remove(r)}else{for(var n=1,o=arguments.length;n<o;n++){t.classList.remove(arguments[n])}}}};e.exports=function(e){var t=new a;var r={};//初始位置数据
var n={};//目标位置数据
var o={};// drag事件跟随手指移动的元素集合
// touchmove事件跟随手指移动的元素
var s={isSert:false,cacheElms:{},currentElm:null};function u(t){var n=x(t.target);var o=b(n),a=o.DDD,f=o.item;var s=a.List.indexOf(f);e.set(f,"dragging",true);r={DDD:a,index:s,item:f,el:n};i.$emit("dragStart",r);l(t,f,n)}
// 设置跟随图片
function l(e,t,r){if(t.followElmData){var n=c(t.followElmData);
//设置touchmove事件跟随图片
s.currentElm=n.forTouchmove;
//设置drag事件跟随图片
if(e.dataTransfer){e.dataTransfer.setDragImage(n.forDrag,n.forDrag.naturalWidth/2,n.forDrag.naturalHeight/2)}}else{
//没有穿数据时默认根源数据为本身
s.currentElm=d(r.cloneNode(true))}}function c(e){if(o[e.src]){return{forDrag:o[e.src],forTouchmove:s.cacheElms[e.src]}}var t=document.createElement("img");t.src=e.src;t.style.width=e.width;t.style.height=e.height;o[e.src]=t;var r=s.cacheElms[e.src]=t.cloneNode(true);d(r);return{forDrag:o[e.src],forTouchmove:s.cacheElms[e.src]}}function d(e){e.style.pointerEvents="none";e.style.position="fixed";e.style.display="block";e.style.opacity=".6";e.dataset.dragFollowElm="true";return e}function v(e){if(e.preventDefault){e.preventDefault()}return false}function g(t){t.stopPropagation();t.preventDefault();
//获取手指当前位置的元素el
//drag事件的e.target指向变更后的元素，touchmove的e.target始终指向触发toucestart事件的对象。因此需要做适配
var o=void 0;if(t.type==="touchmove"){o=A(t);o=x(o);
//touchmove事件需手动设置跟随元素的位置，drag事件无需设置
var a={pageY:t.touches[0].pageY,pageX:t.touches[0].pageX,offsetHeight:t.target.offsetHeight,offsetWidth:t.target.offsetWidth};D(a)}else{o=x(t.target)}
//手指不在draggable元素 || 当前元素为起始元素时
if(!o||o===r.el){E();return}
// 目标元素没改变是return
if(o===n.el){return}
//设置新的draggable元素
E();var f=b(o),s=f.DDD,u=f.item;e.set(u,"drag-enter",true);n.item=u;n.index=s.List.indexOf(u);n.DDD=s;n.el=o;i.$emit("dragged",{from:r,to:n})}function h(e){var t=b(e.target),r=t.item;if(r===n.item){E()}}function m(){}function p(t){t.stopPropagation();t.preventDefault();w(t);
// 移除dragging属性
e.set(r.item,"dragging",false);if(Object.keys(n).length>0){i.$emit("dragend",{from:r,to:n});E()}r={}}function y(e){e.preventDefault();if(e.stopPropagation){e.stopPropagation()}return false}function E(){if(n.el){e.set(n.item,"drag-enter",false);n={}}}function b(e){var r=e.getAttribute("drag_name");var n=e.getAttribute("drag_key");var o=t.new(r);var a=o.KEY_MAP[n];return{DDD:o,item:a}}function D(e){var t=e.pageY,r=e.pageX,n=e.offsetHeight,o=e.offsetWidth;var a=s.currentElm;if(!s.isSert){document.body.append(a);s.isSert=true}var i={top:t-n/2+"px",left:r-o/2+"px"};Object.keys(i).forEach(function(e){a.style[e]=i[e]})}function w(e){if(e.type==="touchend"&&s.currentElm){try{if(s.currentElm.parentNode){s.currentElm.parentNode.removeChild(s.currentElm)}else{document.body.childNodes.forEach(function(e){if(e.dataset&&e.dataset.dragFollowElm){document.body.removeChild(e)}})}s.currentElm=null;s.isSert=false}catch(e){
//
}}}function x(e){if(!e)return;while(e.parentNode){if(e.getAttribute&&e.getAttribute("drag_name")){return e;
// break;
}else{e=e.parentNode}}return false}function A(e){var t=e.touches&&e.touches[0]?e.touches[0]:e.changedTouches&&e.changedTouches[0]?e.changedTouches[0]:e;if(!t)false;var r=document.elementFromPoint(t.clientX,t.clientY);return r}function P(e,r,n){
//子元素都不能选中
n.children.forEach(function(e){if(e.elm&&e.elm.style){e.elm.style.pointerEvents="none"}});var o=r.value.item;var a=r.value.list;var i=t.new(r.value.name);var s=n.key;i.KEY_MAP[s]=o;if(a&&i.List!==a){i.List=a}e.setAttribute("draggable","true");e.setAttribute("drag_name",r.value.name);e.setAttribute("drag_key",s);f.on(e,"dragstart",u);f.on(e,"dragenter",g);f.on(e,"dragover",v);f.on(e,"drag",m);f.on(e,"dragleave",h);f.on(e,"dragend",p);f.on(e,"drop",y);f.on(e,"mousedown",u);f.on(e,"touchstart",u);f.on(e,"touchmove",g);f.on(e,"touchend",p)}function L(e,r,n){var o=t.new(r.value.name);var a=n.key;o.KEY_MAP[a]=undefined;f.off(e,"dragstart",u);f.off(e,"dragenter",g);f.off(e,"dragover",v);f.off(e,"drag",m);f.off(e,"dragleave",h);f.off(e,"dragend",p);f.off(e,"drop",y);f.off(e,"mousedown",u);f.off(e,"touchstart",u);f.off(e,"touchmove",g);f.off(e,"touchend",p)}e.prototype.$dragging=i;e.directive("dragging",{bind:P,update:function e(r,n,o){var a=t.new(n.value.name);var i=n.value.item;var f=n.value.list;var s=o.key;var u=a.KEY_MAP[s];if(i&&u!==i){a.KEY_MAP[s]=i}if(f&&a.List!==f){a.List=f}},unbind:L})};
/***/}
/******/])});